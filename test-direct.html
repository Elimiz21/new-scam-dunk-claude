<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Direct Site Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 40px auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .test-card {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            margin: 5px;
        }
        button:hover {
            background: #2563eb;
        }
        .status {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 13px;
        }
        .success { background: #d1fae5; color: #065f46; }
        .error { background: #fee2e2; color: #991b1b; }
        .warning { background: #fed7aa; color: #92400e; }
        .info { background: #dbeafe; color: #1e40af; }
        pre {
            background: #1e293b;
            color: #94a3b8;
            padding: 15px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>üîç Scam Dunk Direct Testing</h1>
    
    <div class="test-card">
        <h2>Quick Actions</h2>
        <button onclick="window.open('https://scam-dunk-production.vercel.app', '_blank')">
            üåê Open Homepage
        </button>
        <button onclick="window.open('https://scam-dunk-production.vercel.app/scan', '_blank')">
            üîç Open Scan Page
        </button>
        <button onclick="window.open('https://scam-dunk-production.vercel.app/admin/login', '_blank')">
            üîê Open Admin
        </button>
    </div>

    <div class="test-card">
        <h2>JavaScript & Rendering Test</h2>
        <button onclick="testJavaScript()">Run JavaScript Test</button>
        <div id="js-status"></div>
        <pre id="js-result" style="display:none;"></pre>
    </div>

    <div class="test-card">
        <h2>Check Page Resources</h2>
        <button onclick="checkResources()">Check Resources</button>
        <div id="resource-status"></div>
        <pre id="resource-result" style="display:none;"></pre>
    </div>

    <div class="test-card">
        <h2>Test Scan Functionality</h2>
        <button onclick="testScanAPI()">Test Scan API</button>
        <div id="scan-status"></div>
        <pre id="scan-result" style="display:none;"></pre>
    </div>

    <script>
        async function testJavaScript() {
            const statusEl = document.getElementById('js-status');
            const resultEl = document.getElementById('js-result');
            
            statusEl.innerHTML = '<div class="status info">Testing JavaScript loading...</div>';
            resultEl.style.display = 'none';
            
            try {
                const response = await fetch('https://scam-dunk-production.vercel.app');
                const html = await response.text();
                
                // Check for Next.js scripts
                const hasNextScript = html.includes('/_next/static');
                const scriptTags = html.match(/<script[^>]*>/g) || [];
                const nextChunks = html.match(/\/_next\/static\/chunks\/[^"']*/g) || [];
                
                // Check for React root
                const hasReactRoot = html.includes('__next');
                const hasReactId = html.includes('__NEXT_DATA__');
                
                // Extract any error messages
                const errorMatch = html.match(/Error:([^<]*)/);
                const hasError = html.includes('Error') || html.includes('error');
                
                const status = hasNextScript && hasReactRoot ? 'success' : 'warning';
                
                statusEl.innerHTML = `<div class="status ${status}">
                    ${status === 'success' ? '‚úÖ JavaScript appears to be loading correctly' : '‚ö†Ô∏è Potential JavaScript issues detected'}
                </div>`;
                
                resultEl.innerHTML = `Analysis Results:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚úì Next.js Scripts Found: ${hasNextScript ? 'Yes' : 'No'}
‚úì React Root Element: ${hasReactRoot ? 'Yes' : 'No'}
‚úì Next.js Data: ${hasReactId ? 'Yes' : 'No'}
‚úì Script Tags: ${scriptTags.length} found
‚úì Next.js Chunks: ${nextChunks.length} found
‚úì Error Messages: ${errorMatch ? errorMatch[1] : 'None detected'}

Script Chunks Found:
${nextChunks.slice(0, 5).join('\n')}
${nextChunks.length > 5 ? `\n... and ${nextChunks.length - 5} more` : ''}

Page Structure:
- DOCTYPE: ${html.includes('<!DOCTYPE') ? 'Present' : 'Missing'}
- HTML Tag: ${html.includes('<html') ? 'Present' : 'Missing'}
- Body Tag: ${html.includes('<body') ? 'Present' : 'Missing'}
- Main Content: ${html.includes('Scam Dunk') ? 'Found' : 'Missing'}`;
                
                resultEl.style.display = 'block';
                
            } catch (error) {
                statusEl.innerHTML = '<div class="status error">‚ùå Error testing JavaScript</div>';
                resultEl.innerHTML = `Error: ${error.message}\n\nStack:\n${error.stack}`;
                resultEl.style.display = 'block';
            }
        }

        async function checkResources() {
            const statusEl = document.getElementById('resource-status');
            const resultEl = document.getElementById('resource-result');
            
            statusEl.innerHTML = '<div class="status info">Checking resources...</div>';
            resultEl.style.display = 'none';
            
            const resources = [
                '/_next/static/css/app/layout.css',
                '/_next/static/chunks/webpack.js',
                '/_next/static/chunks/main-app.js',
                '/favicon.ico'
            ];
            
            const results = [];
            
            for (const resource of resources) {
                try {
                    const url = `https://scam-dunk-production.vercel.app${resource}`;
                    const response = await fetch(url, { method: 'HEAD' });
                    results.push({
                        resource,
                        status: response.status,
                        ok: response.ok
                    });
                } catch (error) {
                    results.push({
                        resource,
                        status: 'Failed',
                        ok: false,
                        error: error.message
                    });
                }
            }
            
            const allOk = results.every(r => r.ok);
            statusEl.innerHTML = `<div class="status ${allOk ? 'success' : 'warning'}">
                ${allOk ? '‚úÖ All resources loading' : '‚ö†Ô∏è Some resources not found'}
            </div>`;
            
            resultEl.innerHTML = `Resource Check Results:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
${results.map(r => `${r.ok ? '‚úì' : '‚úó'} ${r.resource}
   Status: ${r.status}${r.error ? '\n   Error: ' + r.error : ''}`).join('\n\n')}

Note: Some resources may have different paths in production.
Check the Network tab in DevTools when visiting the site.`;
            
            resultEl.style.display = 'block';
        }

        async function testScanAPI() {
            const statusEl = document.getElementById('scan-status');
            const resultEl = document.getElementById('scan-result');
            
            statusEl.innerHTML = '<div class="status info">Testing scan functionality...</div>';
            resultEl.style.display = 'none';
            
            try {
                const testData = {
                    contactType: 'phone',
                    contactValue: '+1234567890'
                };
                
                const response = await fetch('https://scam-dunk-production.vercel.app/api/contact-verification', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(testData)
                });
                
                const data = await response.json();
                
                statusEl.innerHTML = `<div class="status ${data.success ? 'success' : 'error'}">
                    ${data.success ? '‚úÖ API is working correctly' : '‚ùå API returned an error'}
                </div>`;
                
                resultEl.innerHTML = `API Response:
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
Status: ${response.status}
Success: ${data.success}

Response Data:
${JSON.stringify(data, null, 2)}

This confirms the backend is working properly.
If the UI isn't loading, it's likely a client-side issue.`;
                
                resultEl.style.display = 'block';
                
            } catch (error) {
                statusEl.innerHTML = '<div class="status error">‚ùå API test failed</div>';
                resultEl.innerHTML = `Error: ${error.message}`;
                resultEl.style.display = 'block';
            }
        }

        // Run initial test
        window.addEventListener('load', () => {
            testJavaScript();
        });
    </script>
</body>
</html>