<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scam Dunk - Deployment Test</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #0a0a0a;
            color: #fff;
        }
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }
        h1 { margin: 0; }
        .test-section {
            background: #1a1a1a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }
        .test-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            margin: 10px 0;
            background: #2a2a2a;
            border-radius: 5px;
        }
        .status { 
            padding: 5px 10px;
            border-radius: 5px;
            font-weight: bold;
        }
        .success { background: #22c55e; color: #000; }
        .pending { background: #eab308; color: #000; }
        .error { background: #ef4444; color: #fff; }
        button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #5a67d8; }
        .price-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
        }
        .price-card {
            background: #2a2a2a;
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #444;
        }
        .price { font-size: 24px; font-weight: bold; color: #667eea; }
    </style>
</head>
<body>
    <div class="header">
        <h1>üõ°Ô∏è Scam Dunk - Deployment Test Suite</h1>
        <p>Testing new pricing and API features</p>
    </div>

    <div class="test-section">
        <h2>üìç Environment Tests</h2>
        <div class="test-item">
            <span>Local Development (http://localhost:3000)</span>
            <span id="local-status" class="status pending">Testing...</span>
        </div>
        <div class="test-item">
            <span>Production (https://scam-dunk-production.vercel.app)</span>
            <span id="prod-status" class="status pending">Testing...</span>
        </div>
    </div>

    <div class="test-section">
        <h2>üí∞ New Pricing Structure</h2>
        <div class="price-grid">
            <div class="price-card">
                <h3>Free Trial</h3>
                <div class="price">$0</div>
                <p>1 free test per user</p>
            </div>
            <div class="price-card">
                <h3>Pay Per Scan</h3>
                <div class="price">$4.99</div>
                <p>Per scan</p>
            </div>
            <div class="price-card">
                <h3>Personal</h3>
                <div class="price">$9.99</div>
                <p>Per month (1 user)</p>
            </div>
            <div class="price-card">
                <h3>Family</h3>
                <div class="price">$19.99</div>
                <p>Per month (3 users)</p>
            </div>
            <div class="price-card">
                <h3>Teams</h3>
                <div class="price">$49.99</div>
                <p>Per month (unlimited)</p>
            </div>
        </div>
    </div>

    <div class="test-section">
        <h2>üîå API Endpoint Tests</h2>
        <div class="test-item">
            <span>/api/subscriptions</span>
            <span id="api-subscriptions" class="status pending">Not tested</span>
        </div>
        <div class="test-item">
            <span>/api/check-scan-eligibility</span>
            <span id="api-eligibility" class="status pending">Not tested</span>
        </div>
        <div class="test-item">
            <span>/api/admin/api-keys (CoinMarketCap)</span>
            <span id="api-keys" class="status pending">Not tested</span>
        </div>
        <button onclick="testAPIs('local')">Test Local APIs</button>
        <button onclick="testAPIs('production')">Test Production APIs</button>
    </div>

    <div class="test-section">
        <h2>üìä Test Results</h2>
        <pre id="results" style="background: #000; padding: 15px; border-radius: 5px; overflow-x: auto;">
Waiting for tests...
        </pre>
    </div>

    <script>
        // Check environments
        async function checkEnvironments() {
            // Check local
            try {
                const localResp = await fetch('http://localhost:3000/api/check-scan-eligibility', {
                    method: 'OPTIONS'
                });
                document.getElementById('local-status').className = 'status success';
                document.getElementById('local-status').textContent = 'Running ‚úì';
            } catch (e) {
                document.getElementById('local-status').className = 'status error';
                document.getElementById('local-status').textContent = 'Not running';
            }

            // Check production
            try {
                const prodResp = await fetch('https://scam-dunk-production.vercel.app/', {
                    mode: 'no-cors'
                });
                document.getElementById('prod-status').className = 'status success';
                document.getElementById('prod-status').textContent = 'Live ‚úì';
            } catch (e) {
                document.getElementById('prod-status').className = 'status error';
                document.getElementById('prod-status').textContent = 'Error';
            }
        }

        // Test APIs
        async function testAPIs(env) {
            const baseUrl = env === 'local' 
                ? 'http://localhost:3000' 
                : 'https://scam-dunk-production.vercel.app';
            
            const results = document.getElementById('results');
            results.textContent = `Testing ${env} APIs...\n\n`;

            // Test subscriptions endpoint
            try {
                const subResp = await fetch(`${baseUrl}/api/subscriptions`, {
                    method: 'OPTIONS'
                });
                document.getElementById('api-subscriptions').className = 'status success';
                document.getElementById('api-subscriptions').textContent = 'Working ‚úì';
                results.textContent += `‚úÖ Subscriptions API: Working\n`;
            } catch (e) {
                document.getElementById('api-subscriptions').className = 'status error';
                document.getElementById('api-subscriptions').textContent = 'Failed';
                results.textContent += `‚ùå Subscriptions API: ${e.message}\n`;
            }

            // Test eligibility endpoint
            try {
                const eligResp = await fetch(`${baseUrl}/api/check-scan-eligibility`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email: 'test@example.com' })
                });
                const eligData = await eligResp.json();
                document.getElementById('api-eligibility').className = 'status success';
                document.getElementById('api-eligibility').textContent = 'Working ‚úì';
                results.textContent += `‚úÖ Eligibility API: ${JSON.stringify(eligData, null, 2)}\n`;
            } catch (e) {
                document.getElementById('api-eligibility').className = 'status error';
                document.getElementById('api-eligibility').textContent = 'Failed';
                results.textContent += `‚ùå Eligibility API: ${e.message}\n`;
            }

            results.textContent += `\nüéØ Test completed at ${new Date().toLocaleTimeString()}`;
        }

        // Run initial checks
        checkEnvironments();
    </script>
</body>
</html>